import{S as m,N as u,R as r,m as h,p,q as d,s as t,t as f,H as b}from"./index-DcvvkuKg.js";import{A as _}from"./AppLayout-C8ilSJRN.js";import{D as g}from"./DataTable-B6S0KIo7.js";import{_ as y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const k={components:{Link:m,AppLayout:_,DataTable:g},props:{customer_id:String},data(){return{columns:[{data:"name",name:"name",orderable:!0,searchable:!0},{data:"created_at",name:"created_at",orderable:!0}],columnDefs:[{className:"text-center",targets:[]}],order:[[1,"desc"]],form:u({id:"",status:""})}},mounted(){$("#mytable tbody").on("click","tr .action_delete",s=>{const e=$(s.target).data("item-id");this.selectedRows=[],this.getSelectedItems(e)}),$("#mytable tbody").on("click","tr .action_edit",s=>{const e=$(s.target).data("item-id");this.$inertia.visit(route("customer.edit",e))}),$("#mytable tbody").on("click","tr .action_affiliate_customer",s=>{const e=$(s.target).data("item-id");this.$inertia.visit(route("affilate-customer.view",e))}),$("#mytable tbody").on("click","tr .action_status_change",s=>{const e=$(s.target).data("item-id"),o=$(s.target).data("status");this.updateStatus(e,o)}),$("#mytable tbody").on("click",".item-check input[type=checkbox]",s=>{const e=$(s.target).val();$(s.target).prop("checked")&&!this.selectedRows.includes(e)?this.getSelectedItems(e):this.removeUnselectedItem(e)})},methods:{reloadTable(){this.$refs.datatable.reloadDatatable()},getSelectedItems(s){this.selectedRows.push(s),this.selectedRows.length>0&&(this.$data.isDisabled=!1)},selectAll(s){var e=this;$(s.target).is(":checked")?($(".item-check input[type=checkbox]").prop("checked",!0),$(".item-check input[type=checkbox]:checked").each(function(){e.selectedRows.includes(this.value)||e.getSelectedItems(this.value)}),this.$data.isDisabled=!1):($(".item-check input[type=checkbox]").prop("checked",!1),$(".item-check input[type=checkbox]").each(function(){e.selectedRows.includes(this.value)&&e.removeUnselectedItem(this.value)}),this.$data.isDisabled=!0)},removeUnselectedItem(s){this.selectedRows=this.selectedRows.filter(function(e){return e!=s}),this.selectedRows.length<=0&&($("#selectAll").prop("checked",!1),this.$data.isDisabled=!0)},updateStatus(s,e){this.form.id=s,this.form.status=e,this.form.put(route("customer.change.status"),{preserveScroll:!0,onSuccess:()=>{this.form.reset(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"Staus Updated Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")}})},deleteSelectedItems(){this.form.transform(s=>({...s,ids:[...this.selectedRows]})).post(route("customer.delete"),{onSuccess:()=>{this.resetForm(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")},onFinish:()=>{$("#deleteConfirm").modal("hide"),this.resetForm()}})},resetForm(){this.form.reset("id","status")}}},v={class:"row"},w={class:"col-md-12"},S={class:"card mb-4"},x=t("div",{class:"card-header pb-0"},[t("h5",null,"Affiliate Customer"),t("p",null,"Manage Affiliate Customers."),t("div",{class:"d-flex"})],-1),D={class:"card-body"},A=t("tr",null,[t("th",null,"Customer"),t("th",null,"Joined Date")],-1),R={class:"modal modal-top fade",id:"deleteConfirm",tabindex:"-1","aria-hidden":"true","data-bs-backdrop":"false"},I={class:"modal-dialog modal-sm",role:"document"},C={class:"modal-content"},F=t("div",{class:"modal-header px-3 pb-2"},[t("h5",{class:"modal-title",id:"exampleModalLabel2"},"Are You Sure?")],-1),M=t("div",{class:"modal-body py-0 px-3"},[t("div",{class:"row"},[t("div",{class:"col mb-1"},[t("p",null,"Are you sure you want to delete?")])])],-1),L={class:"modal-footer px-3 pb-3"},E=t("button",{type:"submit",class:"btn btn-sm btn-primary"}," Yes ",-1);function N(s,e,o,T,i,a){const l=r("data-table"),n=r("AppLayout");return h(),p(n,null,{default:d(()=>[t("div",v,[t("div",w,[t("div",S,[x,t("div",D,[f(l,{ref:"datatable",id:"mytable",url:s.route("affilate-customer.getData",{id:o.customer_id}),columns:i.columns,columnDefs:i.columnDefs},{header:d(()=>[A]),_:1},8,["url","columns","columnDefs"])])])]),t("div",R,[t("div",I,[t("div",C,[F,t("form",{id:"formAccountDelete",onSubmit:e[1]||(e[1]=b((...c)=>a.deleteSelectedItems&&a.deleteSelectedItems(...c),["prevent"]))},[M,t("div",L,[t("button",{type:"button",class:"btn btn-sm btn-label-secondary","data-bs-dismiss":"modal",onClick:e[0]||(e[0]=(...c)=>a.resetForm&&a.resetForm(...c))}," Close "),E])],32)])])])])]),_:1})}const q=y(k,[["render",N]]);export{q as default};
